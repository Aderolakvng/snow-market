<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snow Market â€” Premium E-Commerce</title>

    

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">


    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>

    <div id="header-component"></div>

    <section class="hero">
        <div class="hero-content">
            <h1>Discover Premium Products</h1>
            <p>Your one-stop marketplace for quality products.</p>
            <a href="pages/shop.html" class="btn">Shop Now</a>
        
        </div>
    </section>


    <section id="products" class="product-grid">
        <h2 class="section-title">Live Products</h2>

                <div class="products-with-sidebar container">
                    <aside class="category-sidebar" id="externalCategorySidebar"></aside>
                    <div class="grid-container">
                    </div>
                </div>
    </section>

    <div id="footer-component"></div>

    <script type="module" src="js/firebase.js"></script>
    <script src="js/path-utils.js"></script>
    <script type="module" src="js/auth.js"></script>
    <script type="module" src="js/firebase-products.js"></script>
    <script type="module" src="js/cart.js"></script>
    <script type="module" src="js/app.js"></script>
    <script src="js/hero-slider.js"></script>
    <link rel="stylesheet" href="css/external-navbar.css">
    <link rel="stylesheet" href="css/external-hero.css">
    <link rel="stylesheet" href="css/external-products.css">
    <link rel="stylesheet" href="css/external-footer.css">

    <script src="js/path-utils.js"></script>
    <script src="js/asset-logger.js"></script>

    <script src="js/external-app.js"></script>
    <script src="js/header-categories.js"></script>
    <script src="js/header-links-fix.js"></script>

    <script>
    document.addEventListener("DOMContentLoaded", () => {
        document.addEventListener("click", (e) => {
            if (e.target.classList.contains("btn-add-cart")) {
                e.stopPropagation();
                const button = e.target;
                const product = {
                    id: button.getAttribute("data-id"),
                    title: button.getAttribute("data-name"),
                    price: parseFloat(button.getAttribute("data-price")) || 0,
                    imageURL: button.getAttribute("data-img")
                };

                if (window.addToCart) {
                    window.addToCart(product);
                } else {
                    let cart = JSON.parse(localStorage.getItem("cart")) || [];
                    const exists = cart.find(p => p.id === product.id);
                    if (exists) {
                        exists.quantity = (exists.quantity || exists.qty || 0) + 1;
                    } else {
                        cart.push({ ...product, quantity: 1 });
                    }
                    localStorage.setItem("cart", JSON.stringify(cart));
                    alert("Item added to cart");
                }
            }
            
            if (e.target.closest(".product-card") && !e.target.classList.contains("btn-add-cart")) {
                const card = e.target.closest(".product-card");
                const productId = card.getAttribute("data-id");
                if (productId) {
                    window.location.href = (window.resolveRoot ? window.resolveRoot(`pages/product-details.html?id=${productId}`) : `pages/product-details.html?id=${productId}`);
                }
            }
        });
    });
    </script>
        <script>
        fetch("components/header.html")
            .then(res => res.text())
            .then(html => {
                document.getElementById("header-component").innerHTML = html;
                (async function fixHeaderPaths(){
                    const cartLink = document.getElementById('cart-link');
                    const cartImg = document.getElementById('cart-img');

                    async function pickExisting(candidates){
                        for (const c of candidates) {
                            const candidate = window.resolveRoot ? window.resolveRoot(c) : c;
                            try {
                                const res = await fetch(candidate, {method: 'HEAD'});
                                if (res && res.ok) return candidate;
                            } catch (e) {
                                try {
                                    const res2 = await fetch(candidate);
                                    if (res2 && res2.ok) return candidate;
                                } catch (e2) {
                                }
                            }
                        }
                        return window.resolveRoot ? window.resolveRoot(candidates[0]) : candidates[0];
                    }

                    if (cartLink) {
                        const href = await pickExisting(['pages/cart.html','cart.html','/pages/cart.html','/cart.html']);
                        cartLink.href = href;
                    }

                    if (cartImg) {
                        if (cartImg.tagName && cartImg.tagName.toLowerCase() === 'img') {
                            const src = await pickExisting(['images/products/placeholder.svg','images/products/placeholder.jpg','../images/products/placeholder.svg','../images/products/placeholder.jpg','/images/products/placeholder.svg','/images/products/placeholder.jpg']);
                            cartImg.src = src;
                        }
                    }
                    const siteLogo = document.getElementById('siteLogo');
                    if (siteLogo && siteLogo.tagName && siteLogo.tagName.toLowerCase() === 'img'){
                        const logoPath = await pickExisting(['images/logo.png','images/logo@2x.png','images/logo.svg','multimedia/images/logo.png','../images/logo.svg']);
                        siteLogo.src = logoPath;
                        siteLogo.alt = siteLogo.alt || 'Snow Market';

                    }

                    const nav = document.getElementById('navMenu');
                    if (nav) {
                        const links = nav.querySelectorAll('a');
                        for (const a of links) {
                            const text = (a.textContent || a.innerText || '').trim().toLowerCase();
                            let candidates = [];
                            if (text.startsWith('home')) candidates = ['index.html','/index.html','pages/index.html','../index.html'];
                            else if (text.startsWith('shop')) candidates = ['pages/shop.html','shop.html','/pages/shop.html','../shop.html'];
                            else if (text.startsWith('categories')) candidates = ['pages/categories.html','categories.html','/pages/categories.html','../categories.html'];
                            else if (text.startsWith('contact')) candidates = ['pages/contact.html','contact.html','/pages/contact.html','../contact.html'];
                            else if (text.startsWith('customer service')) candidates = ['pages/customer-service.html','customer-service.html','/pages/customer-service.html','../customer-service.html'];
                            if (candidates.length) {
                                pickExisting(candidates).then(found => { a.href = found; });
                            }
                        }
                    }

                    if (window.updateCartCount) window.updateCartCount();
                })();
            });

            fetch("components/footer.html")
                .then(res => res.text())
                .then(html => document.getElementById("footer-component").innerHTML = html);
        </script>
</body>
</html>
